package cn.sirbox.service.impl;

import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import cn.sirbox.dao.ReleaseinfoMapper;
import cn.sirbox.model.Releaseinfo;
import cn.sirbox.service.ReleaseinfoService;

@Service
public class ReleaseinfoServiceimpl implements ReleaseinfoService{
	
	@Autowired
	private ReleaseinfoMapper releaseinfoMapper;
	
	
	//查询所有发布信息
	public List<Releaseinfo> findAll() throws Exception {
		
		return releaseinfoMapper.selectAllReleaseinfo();
	}
	
	//新增发布信息
	public void add(Releaseinfo releaseinfo) throws Exception {
		
		//获取系统当前时间设置为发布信息的创建时间
		SimpleDateFormat sdf = new SimpleDateFormat("yyyy年MM月dd日");
		releaseinfo.setCreateTime(sdf.format(new Date()));
		releaseinfoMapper.insertSelective(releaseinfo);
		
	}
	
	//更新发布信息
	public void update(Releaseinfo releaseinfo) throws Exception {
		
		releaseinfoMapper.updateByPrimaryKeySelective(releaseinfo);
	}
	
	//删除发布信息
	public void delete(Integer id) throws Exception {
		
		releaseinfoMapper.deleteByPrimaryKey(id);
		
	}
	
	//查看发布信息
	public Releaseinfo getReleaseinfo(Integer id) throws Exception {
		
		return null;
	}
	
	//批量审批
	public void update(Integer[] id ,String str) throws Exception {
		
		Releaseinfo releaseinfo = null;
		for(int i=0; i<id.length;i++){
			releaseinfo = new Releaseinfo();
			if("2".equals(str)){
				releaseinfo.setState(2);
			}else{
				releaseinfo.setState(3);
			}					
			releaseinfo.setId(id[i]);
			releaseinfoMapper.updateByPrimaryKeys(releaseinfo);
		}

	}

	//根据id查询发布信息
	public Releaseinfo findById(Integer id) throws Exception {
		
		return releaseinfoMapper.selectByPrimaryKey(id);
	}
	
	public List<Releaseinfo> findByName(String itemBusiness) throws Exception {
		
		Releaseinfo releaseinfo = new Releaseinfo();
		releaseinfo.setItemBusiness(itemBusiness);
		return releaseinfoMapper.selectByExample(releaseinfo);
	}

	public List<Releaseinfo> findByState(Integer states) throws Exception {
		
		Releaseinfo releaseinfo = new Releaseinfo();
		releaseinfo.setState(states);	
		return releaseinfoMapper.selectByExample(releaseinfo);
		
	}
}
