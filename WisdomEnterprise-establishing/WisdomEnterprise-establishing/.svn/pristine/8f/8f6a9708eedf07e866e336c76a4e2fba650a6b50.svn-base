package cn.sirbox.controller;

import java.util.ArrayList;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

import cn.sirbox.model.Result;
import cn.sirbox.service.impl.EnterpriseService;
import net.sf.json.JSONArray;

@Controller
@RequestMapping("statistics")
public class StatisticsController {
    @Autowired
    private EnterpriseService enterpriseService;
    
    
    @RequestMapping("user")
    public String user(Model model){
        Integer year=2016;
        
        Date date = new Date();
        GregorianCalendar gc = new GregorianCalendar();
        gc.setTime(date);
        Integer month=0;
        if(gc.get(gc.YEAR)==year){
            month=gc.get(gc.MONTH)+1;
        }else{
            month=12;
        }
        
        List<String> list=new ArrayList<>();
        list.add(year+"年");
        StringBuffer s=new StringBuffer();
        s.append("[");
        for(int i=0;i<month;i++){
            list.add((i+1)+"月");
            s.append("\'"+(i+1)+"月\',");
        }
        s.deleteCharAt(s.length()-1);
        s.append("]");
        model.addAttribute("list", list);
        List<String> list1=new ArrayList<>();
        list1=enterpriseService.getCountInsert1(year,month);
        StringBuffer s1=listtostring(list1);
        model.addAttribute("s1", s1);
        model.addAttribute("list1", list1);
        
        List<String> list2=new ArrayList<>();
        list2=enterpriseService.getCountInsert2(year,month);
        StringBuffer s2=listtostring(list2);
        model.addAttribute("s2", s2);
        model.addAttribute("list2", list2);
        
        List<String> list3=new ArrayList<>();
        list3=enterpriseService.getCountInsert3(year,month);
        StringBuffer s3=listtostring(list3);
        model.addAttribute("s3", s3);
        model.addAttribute("list3", list3);
        List<String> list4=new ArrayList<>();
        list4=enterpriseService.getCountInsert4(year,month);
        StringBuffer s4=listtostring(list4);
        model.addAttribute("s4", s4);
        model.addAttribute("list4", list4);
        
        List<String> list5=new ArrayList<>();
        list5=enterpriseService.getCountInsert5(year,month);
        StringBuffer s5=listtostring(list5);
        model.addAttribute("s5", s5);
        model.addAttribute("list5", list5);
        
        List<String> list6=new ArrayList<>();
        list6=enterpriseService.getCountInsert6(year,month);
        StringBuffer s6=listtostring(list6);
        model.addAttribute("s6", s6);
        model.addAttribute("list6", list6);
          
        
       
        String m="{name: '用户1',data: [22, 22, 95, 245, 282, 225, 252, 265, 222]}";
        model.addAttribute("s", s);
       model.addAttribute("m", m);
        return "statisticsuser2";
    }
    
    public StringBuffer listtostring(List list){
        StringBuffer ss=new StringBuffer();
        ss.append("{");
        ss.append("name:\'"+list.get(0)+"\',data:[");
        for(int i=1;i<list.size();i++){
            ss.append(list.get(i)+",");
        }
        ss.deleteCharAt(ss.length()-1);
        ss.append("]}");
        return ss;
    }
    
    @RequestMapping("data")
    @ResponseBody
    public Result data(){
        Result result=new Result();
        
        
       
        
      // result.setData(list);
        return result;
    }
}
